import os
import subprocess

def get_applications_list():
    try:
        applications_folder = '/Applications'  # Percorso della cartella Applicazioni
        if os.path.exists(applications_folder):
            applications = []
            for app_name in os.listdir(applications_folder):
                app_path = os.path.join(applications_folder, app_name)
                # Ottieni la versione del programma utilizzando il comando 'mdls'
                result = subprocess.run(['mdls', '-name', 'kMDItemVersion', '-raw', app_path], capture_output=True, text=True)
                if result.returncode == 0:
                    app_version = result.stdout.strip()
                    applications.append((app_name, app_version))
                else:
                    # Se non è possibile ottenere la versione, aggiungi solo il nome del programma
                    applications.append((app_name, "Versione sconosciuta"))
            return applications
        else:
            print("La cartella Applicazioni non esiste.")
            return None
    except Exception as e:
        print("Si è verificato un errore:", e)
        return None

# Esempio di utilizzo della funzione
applications = get_applications_list()
if applications:
    print("Programmi nella cartella Applicazioni:")
    for app, version in applications:
        print(f"{app} - Versione: {version}")
else:
    print("Impossibile ottenere l'elenco dei programmi nella cartella Applicazioni.")
